import{f as w,a as i,t as g}from"../chunks/BVevBz1c.js";import{o as B}from"../chunks/BExjqF4P.js";import{p as C,s as h,f as u,e as L,g as s,i as d,j as n,k as P,t as R}from"../chunks/BL5zx7hf.js";import{i as p}from"../chunks/CrDYz57z.js";import{P as _,s as k}from"../chunks/B5OBbCQf.js";var T=w('<a>Setup OwnTracks App</a> <a download="otrc.json">(OTRC file)</a>',1),U=w('<h1>Setup</h1> <!> <p><a href="/">Home</a></p>',1);function M(x,j){C(j,!0);let t=d("loading"),m=d(void 0);B(async()=>{try{const a=await fetch(`${_}/otrc`);if(a.status==403)s(t,"invalid");else if(a.ok){const o=await a.json(),r=JSON.stringify(o);s(m,btoa(r),!0),s(t,"ok")}else s(t,"error")}catch(a){console.log(a),s(t,"error")}});var v=U(),S=h(u(v),2);{var b=a=>{var o=T(),r=u(o),f=h(r,2);R(()=>{k(r,"href",`owntracks:///config?inline=${n(m)??""}`),k(f,"href",`${_}/otrc`)}),i(a,o)},A=(a,o)=>{{var r=e=>{var l=g("Authorization failed or configuration has expired.");i(e,l)},f=(e,l)=>{{var y=c=>{var O=g("An error occurred while loading the setup configuration.");i(c,O)};p(e,c=>{n(t)==="error"&&c(y)},l)}};p(a,e=>{n(t)==="invalid"?e(r):e(f,!1)},o)}};p(S,a=>{n(t)==="ok"?a(b):a(A,!1)})}P(2),i(x,v),L()}export{M as component};
